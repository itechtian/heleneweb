<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-signin-client_id"
        content="367667795258-7unbip6v5ch3s1iuri7khim2jkn95752.apps.googleusercontent.com">
    <meta name="google-signin-cookiepolicy" content="single_host_origin">
    <meta name="google-signin-scope" content="profile email">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css" type="text/css">
    <title>Helene-web</title>
</head>

<body>

    <main id="login">
        <div class="container text-center">
            <h5 class="small">HELENE BUSINESS</h5>
            <div class="g-signin2" data-onsuccess="onSignIn" id="signinWithGooglebtn"
                style="display: flex; justify-content: center;"></div>

            <script>
                function onSignIn(googleUser) {
                    var id_token = googleUser.getAuthResponse().id_token;

                    // Build Firebase credential with the Google ID token.
                    var credential = firebase.auth.GoogleAuthProvider.credential(id_token);
                    // Sign in with credential from the Google user.
                    firebase.auth().signInWithCredential(credential)
                    .catch((error) => {
                        // Handle Errors here.
                        var errorCode = error.code;
                        console.log(errorCode)
                        var errorMessage = error.message;
                        console.log(errorMessage)
                        // The email of the user's account used.
                        var email = error.email;
                        // The firebase.auth.AuthCredential type that was used.
                        var credential = error.credential;
                        console.log(credential)
                        // ...
                    });
                    const idtoken = credential.idToken;
                    console.log(idtoken)
                    var xhr = new XMLHttpRequest();
                    xhr.open('POST', '/dashboard');
                    xhr.setRequestHeader('Content-Type', 'application/json');
                    xhr.onload = function () {
                        console.log('Signed in as: ' + xhr.responseText);
                        if (xhr.responseText == 'success') {
                            signOut();
                            location.assign('/dashboard')
                        }
                    };
                    xhr.send(JSON.stringify({ idtoken: idtoken }));
                }


                function signOut() {
                    var auth2 = gapi.auth2.getAuthInstance();
                    auth2.signOut().then(function () {
                        console.log('User signed out.');
                    });
                }

            </script>

        </div>
    </main>
    <footer class="bottom text-center py-2">
        <p class="text-dark p-3 m-3 small">Powered By Helene Solutions  &copy; <span id="year"></span></p>
    </footer>
        <script>
    
            var d = new Date();
            var n = d.getFullYear();
            document.getElementById("year").innerHTML = n;
        
        </script>

    <!-- <button type="button" class="btn btn-sm" id="signinWithGooglebtn">Sign in with Google</button> -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-analytics.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.2/firebase-firestore.js"></script>

    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
            apiKey: "AIzaSyATUp1nFk_6iAmecTgIppNH-KCV6c2yoBE",
            authDomain: "helene-e8911.firebaseapp.com",
            projectId: "helene-e8911",
            storageBucket: "helene-e8911.appspot.com",
            messagingSenderId: "367667795258",
            appId: "1:367667795258:web:66302e4990755b65b42c03",
            measurementId: "G-ZGELHY7LS5"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>
    <script src="js/index.js"></script>
    <script src="https://apis.google.com/js/platform.js" async defer></script>
</body>

</html>